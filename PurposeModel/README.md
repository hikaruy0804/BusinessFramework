# 🎨 パーパスモデル作成Webアプリケーション

## 1. サービス概要

| 項目     | 内容                                                       |
| ------ | -------------------------------------------------------- |
| 名称     | Purpose Model Creator                                    |
| 目的     | 共通目的を中心に、関与者の「目的」「役割」「名前」をビジュアルに整理し、関係性を直感的に把握できる共創設計図を作成する |
| 想定ユーザー | 行政職員・NPO職員・企業のプロジェクト担当者・住民・研究者・ファシリテーターなど                |
| 実行環境   | HTML/CSS/JSのみ（サーバ通信不要、ローカル利用可）                           |
| 保存形式   | JSON（再編集可）、PNG（共有・出力用）                               |

---

## 2. デザイン仕様

### 📌 基本構成

*   **中央：共通目的**（タイトル＋補足説明、10文字程度で自動折り返し）
*   **外周：ステークホルダー**（円弧セクションに分割）
*   **上半分**：共創に関与するステークホルダー（Supporting）
*   **下半分**：主体的な共創パートナー（Leading）
*   **円弧構成**：目的（内側2/3・明るい色）→ 役割（外側1/3・薄い色）→ 名前（円の外側）

### 🎨 デザイン指針

| 要素     | 指針                                           |
| ------ | -------------------------------------------- |
| 配色     | レトロモダンな鮮やかな色調（企業：コーラルオレンジ、行政：ブルー、住民：グリーン、専門家：イエロー） |
| 配置     | 円形グリッドに沿って自動整列。各要素はダブルクリックで編集可能。 |
| フォント   | Noto Sans JP（目的タイトル: 20px太字、目的説明: 16px、その他: 18px） |
| UI      | レトロモダンなフラットデザイン（ウォームホワイト背景、ダークグリーングレー文字） |

---

## 3. 主な機能一覧

| 機能              | 内容                                  |
| --------------- | ----------------------------------- |
| ✅ 時間軸管理        | 現在・過去・数年先・将来の4つの時間軸でパーパスモデルを管理・切り替え |
| ✅ パーパス入力        | 中央円のタイトル・補足説明を入力（10文字自動折り返し）                    |
| ✅ ステークホルダー追加    | 「名前」「役割」「目的」「カテゴリ」「配置位置（上/下）」を入力し追加。入力検証機能付き |
| ✅ 自動配置 & 編集     | カテゴリごとにセクションへ自動配置。各要素はダブルクリックでテキスト編集可能。 |
| ✅ 階層的色分け      | カテゴリ色を基準に、「目的・役割」の階層を明るい色→薄い色で表示。 |
| ✅ SVG描画         | ラベル・円弧など全てSVGで描画（リアルタイム更新・アニメーション付き）     |
| ✅ JSON出力・読み込み   | ファイル保存形式で編集内容を出力・読み込みして再編集可能        |
| ✅ PNGエクスポート    | 現在の画面を1000×800pxの画像として出力、資料などで利用可能                |
| ✅ レスポンシブ対応     | モバイル端末でも利用可能なハンバーガーメニュー              |
| ✅ カスタムモーダルダイアログ | 編集、確認、通知用のカスタムダイアログで直感的な操作を提供 |
| ✅ 削除機能         | ステークホルダーの削除機能（編集モーダルから実行）           |
| ✅ 自動保存         | LocalStorageによる自動保存・復元機能                |
| ✅ 選択式スタート      | サンプル付き/クリーンな状態を選択可能                  |
| ✅ 文字数制限        | 適切な表示のための文字数制限（名前・役割10文字、目的・説明20文字、タイトル10文字） |

---

## 4. JSONデータ構造（再編集用）

```json
{
  "currentTimeline": "current",
  "timelineData": {
    "current": {
      "purpose": {
        "title": "パーパス（共通目的）",
        "description": "このプロジェクトで実現したい価値"
      },
      "stakeholders": [
        {
          "id": "uuid-xxxx",
          "name": "大学・研究機関",
          "role": "分析支援",
          "goal": "地域課題の見える化",
          "category": "expert",
          "layer": "supporting"
        }
      ]
    },
    "past": { /* ... */ },
    "near-future": { /* ... */ },
    "future": { /* ... */ }
  }
}
```

*   `category`: `"company"` / `"government"` / `"citizen"` / `"expert"`
*   `layer`: `"supporting"` / `"leading"`

---

## 5. 画面構成

```
+-------------------------------------------------------------+
| ① ヘッダー (レスポンシブ対応：ハンバーガーメニュー)         |
| [新規作成] [データ読込] [データ保存] [PNG出力]              |
+-------------------------------------------------------------+

+--------------------------+----------------------------------+
| ② 編集フォーム          | ③ パーパスモデル図（SVG領域）     |
|--------------------------|----------------------------------|
| 時間軸選択               | [円形レイアウト：カテゴリごとに色分け]|
| 共通目的                 | ・中央：タイトル＋説明（10文字折返）|
| ・タイトル               | ・円弧：目的2/3（明るい） + 役割1/3（薄い）|
| ・説明                   | ・外側：名前（太字）             |
|                          | ・ダブルクリックでテキスト編集     |
| ステークホルダー追加フォーム | ・上段：「共創のステークホルダー」ラベル|
| ・名前                   | ・下段：「主体のステークホルダー」ラベル|
| ・役割                   |                                  |
| ・目的                   |                                  |
| ・カテゴリ選択           |                                  |
| ・上段/下段配置選択      |                                  |
+--------------------------+----------------------------------+
```

---

## 6. 実装技術

| 項目           | 内容                                           |
| ------------ | -------------------------------------------- |
| `start.html` | 選択用ランディングページ（サンプル付き/クリーンを選択）                          |
| `sample.html` | サンプルデータ付きメイン画面                          |
| `index.html` | クリーンな状態のメイン画面                          |
| `style.css`  | レトロモダンデザイン、円形グリッド、レスポンシブ対応              |
| `script-sample.js`  | サンプルデータ付き機能処理、LocalStorage管理                    |
| `script-clean.js`  | クリーンな状態の機能処理、LocalStorage管理                    |
| 使用ライブラリ  | `d3.js` v7 (SVG描画), `FileSaver.js` (ファイル保存), `uuid` (ID生成) |

---

## 7. ファイル構成

```
purpose/
├─ start.html           # スタートページ（サンプル付き/クリーンを選択）
├─ sample.html          # サンプルデータ付きメイン画面
├─ index.html           # クリーンな状態のメイン画面
├─ style.css            # レトロモダンデザイン
├─ script-sample.js     # サンプルデータ付き機能処理
├─ script-clean.js      # クリーンな状態の機能処理
├─ sample-data.json     # サンプルデータファイル
├─ README.md            # 本ドキュメント
└─ odl/                 # 旧ファイル・作業用ファイル保管
    ├─ script.js        # 旧メインスクリプト
    ├─ test.html        # テスト用ファイル
    └─ ...              # その他の旧ファイル
```

### 📂 ファイルの使い分け

| ファイル | 用途 | 初期データ | LocalStorageキー |
|---------|------|-----------|-----------------|
| `start.html` | 選択画面 | - | - |
| `sample.html` | 学習・デモ用 | サンプルステークホルダー4つ | `purpose-model-data-sample` |
| `index.html` | 実プロジェクト用 | なし（クリーン） | `purpose-model-data-clean` |

---

## 8. 出力ファイル形式

| 種別      | 用途                 | サイズ |
| ------- | ------------------ | ----- |
| `.json` | 再編集用保存形式           | - |
| `.png`  | 画像出力（印刷・SNS共有用）    | 1000×800px |

---

## 9. カラーパレット

| カテゴリ | 色コード | 色名 | 内側（目的） | 外側（役割） |
| ------ | ------- | --- | ----------- | ----------- |
| 企業 | #69DB7C | グリーン | 少し暗いグリーン | 薄いグリーン |
| 行政 | #FFD43B | イエロー | 少し暗いイエロー | 薄いイエロー |
| 住民 | #FF8A65 | コーラルオレンジ | 少し暗いオレンジ | 薄いオレンジ |
| 専門家 | #5C7CFA | ブルー | 少し暗いブルー | 薄いブルー |
| UI背景 | #F4F3EE | ウォームホワイト | - | - |
| UI文字 | #2F3E46 | ダークグリーングレー | - | - |

---

## 10. 使用方法

1.  **開始方法の選択**：ブラウザで `start.html` を開き、サンプル付きまたはクリーンな状態を選択
2.  **時間軸選択**：上部のドロップダウンから時間軸（現在、過去、数年先、将来）を選択
3.  **パーパス設定**：中央の共通目的を入力
4.  **ステークホルダー追加**：左パネルから関係者を追加
5.  **編集**：円弧上の要素をダブルクリックで直接編集
6.  **削除**：編集モーダルの削除ボタンでステークホルダーを削除
7.  **保存**：JSON形式で保存、または画像出力

### 🚀 クイックスタート

- **初めて使用する場合**: `start.html` → `sample.html` を選択
- **実際のプロジェクトで使用**: `start.html` → `index.html` を選択
- **直接アクセス**: 
  - サンプル付き: `sample.html`
  - クリーン: `index.html`

---

## 11. 特徴

*   **サーバー不要**：完全にクライアントサイドで動作
*   **時間軸管理**：複数の時間軸でパーパスモデルを管理し、変化を追跡可能
*   **直感的操作**：ダブルクリック編集、リアルタイム更新、カスタムモーダルダイアログ
*   **レトロモダンデザイン**：温かみのある色調と洗練されたUI
*   **高い可読性**：適切なフォントサイズとコントラスト、階層的色分け
*   **柔軟な出力**：JSON再編集、PNG画像出力対応
*   **データ永続化**：LocalStorageによる自動保存で画面更新後もデータ保持
*   **削除機能**：安全な確認ダイアログ付きステークホルダー削除
*   **選択式スタート**：学習用サンプルと実用クリーン版を選択可能

---

## 12. 技術的特徴

### 🔧 データ管理
- **時間軸別データ分離**: 各時間軸で独立したデータ管理
- **自動保存**: 入力・編集・削除時の即座なLocalStorage保存
- **データ整合性**: 画面更新・PNG出力後もデータ保持

### 🎨 描画・UI
- **SVGベース**: スケーラブルで高品質な描画
- **アニメーション**: 要素追加・削除時のスムーズなアニメーション
- **レスポンシブ**: モバイル対応のハンバーガーメニュー

### 💾 出力機能
- **PNG出力**: 正確な中央配置、完全な要素表示
- **JSON出力**: 完全な再編集可能形式
- **データ保護**: 出力処理中のデータ保持

---
